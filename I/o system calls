#include <stdio.h>
#include <fcntl.h>      // open, creat
#include <unistd.h>     // read, write, lseek, close
#include <string.h>
#include <sys/stat.h>   // stat

int main() {
    int fd;
    char buffer[100];
    struct stat fileStat;

    // 1. Create and open file
    fd = open("demo.txt", O_CREAT | O_RDWR, 0777); // read & write
    if (fd < 0) {
        perror("open");
        return 1;
    }

    // 2. Write to file
    char msg[] = "Hello, I/O System Calls!";
    write(fd, msg, strlen(msg));

    // 3. Move cursor to beginning
    lseek(fd, 0, SEEK_SET);

    // 4. Read from file
    int n = read(fd, buffer, sizeof(buffer)-1);
    buffer[n] = '\0';
    printf("File content: %s\n", buffer);

    // 5. File information using stat()
    fstat(fd, &fileStat);
    printf("File size: %ld bytes\n", fileStat.st_size);

    // 6. Close file
    close(fd);

    return 0;
}
